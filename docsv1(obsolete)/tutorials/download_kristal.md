
# Download a Kristal

## Status
DRAFT

## 1. Goal

This tutorial explains how a user (or an application) downloads a **part of the knowledge** they need as a Kristal, so it can be:
- queried locally,
- used by AI offline,
- edited and improved,
- merged back later.

A “download” can mean:
- downloading a **ready-to-go Kristal pack** (curated by domain),
- downloading a **slice** generated by a query (database-style extraction),
- downloading a **bundle set** (multiple Kristals + indexes).

---

## 2. Common Download Modes

### 2.1 Download a curated domain pack (recommended)
A registry may publish curated Kristals by field of expertise, for example:

- `kristal://plants.core`
- `kristal://chemistry.core`
- `kristal://history.canada.core`

These packs are typically:
- validated,
- versioned,
- tagged by domain (e.g., UNESCO code + Wikidata QIDs).

**Example (conceptual CLI)**
```bash
kristal pull kristal://plants.core --out ./kristals/
````

Expected outputs:

* `plants.core.kristal.json`
* optional sidecars (indexes, traces, signatures)

### 2.2 Download by domain tag (UNESCO-aligned)

If the registry supports UNESCO field tags:

```bash
kristal search --domain unesco:<code>
kristal pull --domain unesco:<code> --best
```

Meaning:

* list Kristals tagged with that domain
* download the preferred one (“best” can be latest stable, highest validation, etc.)

### 2.3 Download a query-built slice (database-style)

Instead of a curated pack, you request a slice.

**Example**

```bash
kristal slice \
  --from kristal://global.core \
  --sparql 'SELECT ?s WHERE { ?s P31 Q756 . }' \
  --closure outgoing \
  --depth 1 \
  --out ./kristals/plants.slice.kristal.json
```

This:

* runs the query,
* collects matching entities + claims,
* applies closure rules (dependencies),
* emits a new Kristal derived from the source.

### 2.4 Download from a QID seed (topic-centered pack)

You can seed a download from a single entity:

```bash
kristal pull --seed Q42231 --closure outgoing --depth 2
```

Typical use:

* “download everything around botany”
* “download everything around photosynthesis”

### 2.5 Download with/without traces

Traces can be large. Download options should include:

* `--traces none` (default)
* `--traces refs` (keep references only)
* `--traces bundle` (download trace bundle too)

Example:

```bash
kristal pull kristal://plants.core --traces bundle
```

---

## 3. What You Receive

A downloaded Kristal may arrive in one of these forms:

### 3.1 Single file

* `*.kristal.json`
  Contains:
* manifest
* qitems
* claims
* embedded or referenced charters
* optional index

### 3.2 Pack archive (offline bundle)

* `*.kristal.pack.zip`

Typical contents:

* `kristal.json`
* `index.json` or `index/`
* `trace.bundle.json` (optional)
* `signatures/` (optional)
* `manifest.json` (optional for pack-level metadata)

---

## 4. Integrity Checks

After download, clients SHOULD verify:

### 4.1 Content hash

* recompute the Kristal hash and compare with `kristal_id`

### 4.2 Signature (optional)

If `manifest.signature` exists:

* verify signature using a trusted key source

### 4.3 Charter availability

If the Kristal references external charters:

* ensure charter refs are available locally
* otherwise fetch them from the registry (if allowed)

---

## 5. Minimal Example (Local Store)

A simple local layout:

```
./kristals/
  plants.core.kristal.json
  charters/
    general.charter.json
  traces/
    trace.bundle.plants.core.json
  indexes/
    plants.core.index.json
```

---

## 6. Next Steps

* Edit and enhance a Kristal: `docs/en/tutorials/edit_kristal.md`
* Reload Kristals into a local query engine or AI runtime: `docs/en/tutorials/reload_kristal.md`


